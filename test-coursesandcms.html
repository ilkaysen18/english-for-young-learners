<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>English Training Hub - Platform</title>
<link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap" rel="stylesheet">
<style>
:root {
  --primary:#0078d7;
  --primary-dark:#005fa3;
  --bg-light:#f4f4f4;
  --card:#fff;
  --text:#222;
}

* {
  box-sizing: border-box;
}

body {
  margin:0;
  font-family:'Comic Neue',sans-serif;
  background:linear-gradient(to bottom,#a7dfff,#f6faff);
  min-height:100vh;
  color:var(--text);
}

.header {
  background:var(--primary);
  color:#fff;
  padding:1rem;
  text-align:center;
  box-shadow:0 2px 10px rgba(0,0,0,0.1);
}

.header h1 {
  margin:0;
  font-size:1.8rem;
}

.header p {
  margin:0.3rem 0 0 0;
  opacity:0.9;
  font-size:0.95rem;
}

.container {
  max-width:1000px;
  margin:0 auto;
  padding:20px;
}

/* Course Selection View */
.course-selection {
  text-align:center;
  padding:20px 0;
}

.course-selection h2 {
  font-size:2em;
  margin:20px 0;
  color:#333;
}

.course-grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:25px;
  margin:30px 0;
}

.course-card {
  background:white;
  border-radius:20px;
  padding:30px 20px;
  box-shadow:0 5px 15px rgba(0,0,0,0.15);
  cursor:pointer;
  transition:transform 0.3s ease, box-shadow 0.3s ease;
  border:3px solid transparent;
}

.course-card:hover {
  transform:translateY(-5px);
  box-shadow:0 8px 20px rgba(0,0,0,0.2);
}

.course-card.kids {
  border-color:#ffd34e;
  background:linear-gradient(to bottom, #fff8e1, #ffffff);
}

.course-card.general {
  border-color:#764ba2;
  background:linear-gradient(135deg, #f5f3ff 0%, #ffffff 100%);
}

.course-card.speaking {
  border-color:#ff6348;
  background:linear-gradient(to right, #fff5f3, #ffffff);
}

.course-card h3 {
  font-size:1.8em;
  margin:10px 0;
  color:#333;
}

.course-card p {
  font-size:1em;
  color:#666;
  margin:10px 0;
}

.course-icon {
  font-size:3em;
  margin:10px 0;
}

/* Course View */
.course-view {
  display:none;
}

.course-view.active {
  display:block;
  animation:fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from { opacity:0; transform:translateY(20px); }
  to { opacity:1; transform:translateY(0); }
}

.back-btn {
  background:#555;
  color:white;
  border:none;
  padding:12px 24px;
  border-radius:10px;
  font-size:1em;
  cursor:pointer;
  margin-bottom:20px;
  box-shadow:0 3px 0 #333;
  font-family:'Comic Neue',sans-serif;
  font-weight:700;
}

.back-btn:hover {
  background:#666;
}

.course-header {
  background:white;
  border-radius:20px;
  padding:20px;
  margin-bottom:30px;
  box-shadow:0 5px 15px rgba(0,0,0,0.1);
  text-align:center;
}

.course-header h2 {
  font-size:2.5em;
  margin:10px 0;
}

.lessons-container {
  display:flex;
  flex-direction:column;
  gap:20px;
}

.lesson-card {
  background:white;
  border-radius:20px;
  padding:25px;
  box-shadow:0 5px 15px rgba(0,0,0,0.15);
  transition:transform 0.3s ease;
}

.lesson-card:hover {
  transform:translateY(-3px);
}

.lesson-card h3 {
  font-size:1.8em;
  margin:0 0 15px 0;
  color:var(--primary);
}

.lesson-content {
  font-size:1.2em;
  line-height:1.6;
}

.lesson-content p {
  margin:10px 0;
  text-align:left;
}

.lesson-nav {
  margin-top:20px;
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  justify-content:center;
}

.lesson-nav a, .lesson-nav button {
  text-decoration:none;
  background:#0078d7;
  color:white;
  padding:12px 20px;
  border-radius:10px;
  border:none;
  cursor:pointer;
  font-family:'Comic Neue',sans-serif;
  font-weight:700;
  font-size:1em;
  transition:background 0.3s ease;
}

.lesson-nav a:hover, .lesson-nav button:hover {
  background:#005fa3;
}

/* Kids English Styling */
.course-kids-eng .course-header {
  background:linear-gradient(to bottom, #a7dfff, #f6faff);
  font-family:'Comic Neue',cursive;
}

.course-kids-eng .lesson-card {
  background:linear-gradient(to bottom, #fff8e1, #ffffff);
  border:3px solid #ffd34e;
  font-family:'Comic Neue',cursive;
}

.course-kids-eng .lesson-card h3 {
  color:#e0a800;
}

.course-kids-eng .lesson-content {
  font-size:1.5em;
}

.course-kids-eng .lesson-nav a, .course-kids-eng .lesson-nav button {
  background:#ffd34e;
  color:#333;
  box-shadow:0 3px 0 #e0a800;
}

.course-kids-eng .lesson-nav a:hover, .course-kids-eng .lesson-nav button:hover {
  background:#ffe678;
}

/* General English Styling */
.course-gen-eng .course-header {
  background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color:white;
  font-family:Georgia,serif;
}

.course-gen-eng .lesson-card {
  background:linear-gradient(135deg, #f5f3ff 0%, #ffffff 100%);
  border:3px solid #764ba2;
  font-family:Georgia,serif;
}

.course-gen-eng .lesson-card h3 {
  color:#764ba2;
}

.course-gen-eng .lesson-nav a, .course-gen-eng .lesson-nav button {
  background:#764ba2;
  font-family:Georgia,serif;
}

.course-gen-eng .lesson-nav a:hover, .course-gen-eng .lesson-nav button:hover {
  background:#5a3777;
}

/* Speaking with Pictures Styling */
.course-spkpiceng .course-header {
  background:linear-gradient(to right, #ff7e5f, #feb47b);
  color:#2c3e50;
  font-family:'Trebuchet MS',sans-serif;
}

.course-spkpiceng .lesson-card {
  background:linear-gradient(to right, #fff5f3, #ffffff);
  border:3px solid #ff6348;
  font-family:'Trebuchet MS',sans-serif;
  color:#2c3e50;
}

.course-spkpiceng .lesson-card h3 {
  color:#ff6348;
}

.course-spkpiceng .lesson-nav a, .course-spkpiceng .lesson-nav button {
  background:#ff6348;
  color:white;
  box-shadow:0 4px 0 #d14836;
  font-family:'Trebuchet MS',sans-serif;
}

.course-spkpiceng .lesson-nav a:hover, .course-spkpiceng .lesson-nav button:hover {
  background:#ff7f6e;
}

/* Loading State */
.loading {
  text-align:center;
  padding:40px;
  font-size:1.5em;
  color:#666;
}

.loading::after {
  content:'...';
  animation:dots 1.5s steps(4, end) infinite;
}

@keyframes dots {
  0%, 20% { content:''; }
  40% { content:'.'; }
  60% { content:'..'; }
  80%, 100% { content:'...'; }
}

/* Empty State */
.empty-state {
  text-align:center;
  padding:60px 20px;
  background:white;
  border-radius:20px;
  box-shadow:0 5px 15px rgba(0,0,0,0.1);
}

.empty-state h3 {
  font-size:2em;
  margin:20px 0;
  color:#999;
}

.empty-state p {
  font-size:1.2em;
  color:#666;
}

/* CMS Access Button */
.cms-access {
  position:fixed;
  bottom:20px;
  right:20px;
  background:var(--primary);
  color:white;
  border:none;
  padding:15px 25px;
  border-radius:50px;
  font-size:1em;
  cursor:pointer;
  box-shadow:0 4px 15px rgba(0,120,215,0.4);
  font-family:'Comic Neue',sans-serif;
  font-weight:700;
  z-index:1000;
  transition:all 0.3s ease;
}

.cms-access:hover {
  background:var(--primary-dark);
  transform:scale(1.05);
  box-shadow:0 6px 20px rgba(0,120,215,0.6);
}

/* CMS Panel */
.cms-panel {
  display:none;
  position:fixed;
  top:0;
  left:0;
  right:0;
  bottom:0;
  background:rgba(0,0,0,0.7);
  z-index:2000;
  overflow-y:auto;
  padding:20px;
}

.cms-panel.active {
  display:block;
  animation:fadeIn 0.3s ease;
}

.cms-content {
  max-width:800px;
  margin:20px auto;
  background:white;
  border-radius:20px;
  padding:30px;
  box-shadow:0 5px 30px rgba(0,0,0,0.3);
}

.cms-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
  padding-bottom:15px;
  border-bottom:2px solid #eee;
}

.cms-header h2 {
  margin:0;
  font-size:2em;
  color:var(--primary);
}

.close-cms {
  background:#dc3545;
  color:white;
  border:none;
  padding:10px 20px;
  border-radius:10px;
  cursor:pointer;
  font-family:'Comic Neue',sans-serif;
  font-weight:700;
  font-size:1em;
}

.close-cms:hover {
  background:#c82333;
}

.cms-form {
  margin:20px 0;
}

.form-group {
  margin-bottom:15px;
}

.form-group label {
  display:block;
  font-weight:600;
  margin-bottom:5px;
  color:#333;
}

.form-group input,
.form-group textarea,
.form-group select {
  width:100%;
  padding:12px;
  border:2px solid #ddd;
  border-radius:10px;
  font-size:16px;
  font-family:'Comic Neue',sans-serif;
}

.form-group textarea {
  resize:vertical;
  min-height:120px;
}

.submit-btn {
  background:#28a745;
  color:white;
  border:none;
  padding:15px 30px;
  border-radius:10px;
  font-size:1.1em;
  cursor:pointer;
  font-family:'Comic Neue',sans-serif;
  font-weight:700;
  width:100%;
  margin-top:10px;
}

.submit-btn:hover {
  background:#218838;
}

.toggle-form-btn {
  background:var(--primary);
  color:white;
  border:none;
  padding:12px 24px;
  border-radius:10px;
  cursor:pointer;
  font-family:'Comic Neue',sans-serif;
  font-weight:700;
  font-size:1em;
  margin-bottom:20px;
}

.toggle-form-btn:hover {
  background:var(--primary-dark);
}

.cms-lessons-list {
  margin-top:30px;
  padding-top:20px;
  border-top:2px solid #eee;
}

.cms-lessons-list h3 {
  font-size:1.5em;
  margin-bottom:15px;
  color:#333;
}

.cms-lesson-item {
  background:#f8f9fa;
  padding:15px;
  border-radius:10px;
  margin-bottom:10px;
  border-left:4px solid var(--primary);
}

.cms-lesson-item strong {
  color:var(--primary);
}

.cms-lesson-item small {
  color:#666;
  font-size:0.9em;
}

/* Responsive Design */
@media (max-width: 768px) {
  .course-grid {
    grid-template-columns:1fr;
  }

  .course-header h2 {
    font-size:2em;
  }

  .lesson-card h3 {
    font-size:1.5em;
  }

  .lesson-content {
    font-size:1.1em;
  }

  .cms-access {
    bottom:10px;
    right:10px;
    padding:12px 20px;
    font-size:0.9em;
  }

  .cms-content {
    padding:20px;
  }
}
</style>
</head>
<body>

<!-- Header -->
<div class="header">
  <h1>üåç English Training Hub</h1>
  <p>Interactive Language Learning Platform</p>
</div>

<div class="container">

  <!-- Course Selection View -->
  <div class="course-selection" id="courseSelection">
    <h2>Choose Your Course üöÄ</h2>
    <div class="course-grid">

      <div class="course-card kids" onclick="loadCourse('https://ilkaysen18.github.io/englishtraininghub/kids-eng.html')">
        <div class="course-icon">üçè</div>
        <h3>KIDS ENGLISH</h3>
        <p>Fun and engaging lessons for young learners</p>
      </div>

      <div class="course-card general" onclick="loadCourse('gen-eng')">
        <button onclick="window.location.href='https://ilkaysen18.github.io/englishtraininghub/gen-eng.html'">
        <div class="course-icon">ü¶ò</div>
        <h3>GENERAL ENGLISH</h3>
        <p>Comprehensive English for all levels</p>
      </div>

      <div class="course-card speaking" onclick="loadCourse('spkpiceng')">
        <button onclick="window.location.href='https://ilkaysen18.github.io/englishtraininghub/spkpiceng.html'">
        <div class="course-icon">üñºÔ∏è</div>
        <h3>SPEAKING WITH PICTURES</h3>
        <p>Visual learning for better communication</p>
      </div>

    </div>
  </div>

  <!-- Course View (Kids English) -->
  <div class="course-view course-kids-eng" id="view-kids-eng">
    <button class="back-btn" onclick="backToSelection()">‚Üê Back to Courses</button>
    <div class="course-header">
      <h2>üçè KIDS ENGLISH</h2>
      <p>Fun and engaging lessons for young learners!</p>
    </div>
    <div class="lessons-container" id="lessons-kids-eng">
      <div class="loading">Loading lessons</div>
    </div>
  </div>

  <!-- Course View (General English) -->
  <div class="course-view course-gen-eng" id="view-gen-eng">
    <button class="back-btn" onclick="backToSelection()">‚Üê Back to Courses</button>
    <div class="course-header">
      <h2>ü¶ò GENERAL ENGLISH</h2>
      <p>Comprehensive English for all levels</p>
    </div>
    <div class="lessons-container" id="lessons-gen-eng">
      <div class="loading">Loading lessons</div>
    </div>
  </div>

  <!-- Course View (Speaking with Pictures) -->
  <div class="course-view course-spkpiceng" id="view-spkpiceng">
    <button class="back-btn" onclick="backToSelection()">‚Üê Back to Courses</button>
    <div class="course-header">
      <h2>üñºÔ∏è SPEAKING WITH PICTURES</h2>
      <p>Visual learning for better communication</p>
    </div>
    <div class="lessons-container" id="lessons-spkpiceng">
      <div class="loading">Loading lessons</div>
    </div>
  </div>

</div>

<!-- CMS Access Button -->
<button class="cms-access" onclick="openCMS()">üìù CMS</button>

<!-- CMS Panel -->
<div class="cms-panel" id="cmsPanel">
  <div class="cms-content">
    <div class="cms-header">
      <h2>üìö Content Management System</h2>
      <button class="close-cms" onclick="closeCMS()">‚úï Close</button>
    </div>

    <button class="toggle-form-btn" id="toggleFormBtn" onclick="toggleForm()">‚ûï New Lesson</button>

    <form class="cms-form" id="lessonForm" style="display:none;">
      <div class="form-group">
        <label>Select Course:</label>
        <select id="courseSelect" required>
          <option value="">-- Choose a Course --</option>
          <option value="kids-eng">KIDS ENGLISH üçè</option>
          <option value="gen-eng">GENERAL ENGLISH ü¶ò</option>
          <option value="spkpiceng">SPEAKING WITH PICTURES üñº</option>
        </select>
      </div>

      <div class="form-group">
        <label>Lesson Number:</label>
        <input id="lessonOrder" type="number" placeholder="e.g., 1" required>
      </div>

      <div class="form-group">
        <label>Lesson Title:</label>
        <input id="lessonTitle" placeholder="e.g., Lesson 1 ‚Äì Animals üê∂" required>
      </div>

      <div class="form-group">
        <label>Lesson Content:</label>
        <textarea id="lessonBody" placeholder="Enter lesson content here..." required></textarea>
      </div>

      <button type="submit" class="submit-btn">üíæ Save Lesson</button>
    </form>

    <div class="cms-lessons-list" id="cmsLessonsList">
      <h3>üìò All Lessons</h3>
      <div id="lessonsListContent"></div>
    </div>
  </div>
</div>

<script type="module">
// Firebase modular v9+ imports
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-analytics.js";
import {
  getFirestore,
  collection,
  addDoc,
  getDocs,
  orderBy,
  query,
  where,
} from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyBx4To2-DIglfgq_eHve3bYXYKdsZ0sgEo",
  authDomain: "english-training-hub.firebaseapp.com",
  projectId: "english-training-hub",
  storageBucket: "english-training-hub.firebasestorage.app",
  messagingSenderId: "927072446139",
  appId: "1:927072446139:web:721de952b0e0b7aa19ab9e",
  measurementId: "G-34BBV99KXB",
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
try { getAnalytics(app); } catch (_) {}
const db = getFirestore(app);

// Global functions for navigation
window.loadCourse = async function(courseId) {
  // Hide course selection
  document.getElementById('courseSelection').style.display = 'none';

  // Show selected course view
  const courseView = document.getElementById(`view-${courseId}`);
  courseView.classList.add('active');

  // Load lessons for this course
  await loadCourseLessons(courseId);

  // Scroll to top
  window.scrollTo(0, 0);
}

window.backToSelection = function() {
  // Hide all course views
  document.querySelectorAll('.course-view').forEach(view => {
    view.classList.remove('active');
  });

  // Show course selection
  document.getElementById('courseSelection').style.display = 'block';

  // Scroll to top
  window.scrollTo(0, 0);
}

window.openCMS = function() {
  document.getElementById('cmsPanel').classList.add('active');
  loadCMSLessons();
}

window.closeCMS = function() {
  document.getElementById('cmsPanel').classList.remove('active');
}

window.toggleForm = function() {
  const form = document.getElementById('lessonForm');
  form.style.display = form.style.display === 'none' ? 'block' : 'none';
}

// Custom alert function
function showAlert(message) {
  const modal = document.createElement('div');
  modal.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:9999;';
  modal.innerHTML = `
    <div style="background:white;padding:30px;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,0.3);max-width:400px;margin:20px;text-align:center;">
      <p style="margin:0 0 20px 0;color:#222;font-size:1.2em;font-family:'Comic Neue',sans-serif;">${message}</p>
      <button onclick="this.closest('div[style*=fixed]').remove()" style="background:#0078d7;color:white;border:none;padding:12px 24px;border-radius:10px;cursor:pointer;font-weight:600;font-family:'Comic Neue',sans-serif;font-size:1em;">OK</button>
    </div>
  `;
  document.body.appendChild(modal);
}

// Load lessons for a specific course
async function loadCourseLessons(courseId) {
  const container = document.getElementById(`lessons-${courseId}`);
  container.innerHTML = '<div class="loading">Loading lessons</div>';

  try {
    const q = query(
      collection(db, "lessons"),
      where("course", "==", courseId),
      orderBy("order", "asc")
    );
    const snap = await getDocs(q);

    if (snap.empty) {
      container.innerHTML = `
        <div class="empty-state">
          <h3>üìö</h3>
          <h3>No lessons yet</h3>
          <p>Lessons will appear here once they are created in the CMS.</p>
        </div>
      `;
      return;
    }

    container.innerHTML = '';
    const lessons = [];
    snap.forEach((doc) => {
      lessons.push(doc.data());
    });

    lessons.forEach((lesson, index) => {
      const lessonCard = document.createElement('div');
      lessonCard.className = 'lesson-card';
      lessonCard.id = `lesson-${courseId}-${lesson.order}`;

      // Format content
      const lines = (lesson.content || "").split("\n").filter(line => line.trim());
      const contentHtml = lines.map(line => {
        return `<p>${line}</p>`;
      }).join("");

      // Create navigation
      let navHtml = '<div class="lesson-nav">';
      if (index > 0) {
        navHtml += `<a href="#lesson-${courseId}-${lessons[index-1].order}">‚Üê Previous</a>`;
      }
      navHtml += `<button onclick="backToSelection()">üè† All Courses</button>`;
      if (index < lessons.length - 1) {
        navHtml += `<a href="#lesson-${courseId}-${lessons[index+1].order}">Next ‚Üí</a>`;
      }
      navHtml += '</div>';

      lessonCard.innerHTML = `
        <h3>${lesson.title}</h3>
        <div class="lesson-content">
          ${contentHtml}
        </div>
        ${navHtml}
      `;

      container.appendChild(lessonCard);
    });

  } catch (error) {
    console.error("Error loading lessons:", error);
    container.innerHTML = `
      <div class="empty-state">
        <h3>‚ö†Ô∏è</h3>
        <h3>Error loading lessons</h3>
        <p>${error.message}</p>
      </div>
    `;
  }
}

// Load all lessons for CMS view
async function loadCMSLessons() {
  const container = document.getElementById('lessonsListContent');
  container.innerHTML = '<div class="loading">Loading lessons</div>';

  try {
    const q = query(collection(db, "lessons"), orderBy("course", "asc"), orderBy("order", "asc"));
    const snap = await getDocs(q);

    if (snap.empty) {
      container.innerHTML = '<p style="text-align:center;color:#999;">No lessons created yet.</p>';
      return;
    }

    container.innerHTML = '';
    const courseNames = {
      'kids-eng': 'KIDS ENGLISH üçè',
      'gen-eng': 'GENERAL ENGLISH ü¶ò',
      'spkpiceng': 'SPEAKING WITH PICTURES üñº'
    };

    snap.forEach((doc) => {
      const lesson = doc.data();
      const lessonItem = document.createElement('div');
      lessonItem.className = 'cms-lesson-item';
      lessonItem.innerHTML = `
        <strong>#${lesson.order}</strong> ${lesson.title}<br>
        <small>${courseNames[lesson.course] || lesson.course}</small>
      `;
      container.appendChild(lessonItem);
    });

  } catch (error) {
    console.error("Error loading CMS lessons:", error);
    container.innerHTML = `<p style="text-align:center;color:#dc3545;">Error: ${error.message}</p>`;
  }
}

// Handle form submission
document.getElementById('lessonForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const course = document.getElementById('courseSelect').value;
  const order = parseInt(document.getElementById('lessonOrder').value, 10);
  const title = document.getElementById('lessonTitle').value.trim();
  const content = document.getElementById('lessonBody').value.trim();

  if (!course || !Number.isFinite(order) || !title || !content) {
    showAlert('Please fill in all fields');
    return;
  }

  try {
    await addDoc(collection(db, "lessons"), {
      course,
      order,
      title,
      content,
      timestamp: Date.now()
    });

    showAlert('‚úÖ Lesson saved successfully!');

    // Reset form
    document.getElementById('lessonForm').reset();
    document.getElementById('lessonForm').style.display = 'none';

    // Reload CMS lessons list
    await loadCMSLessons();

    // If we're viewing this course, reload it
    const courseView = document.getElementById(`view-${course}`);
    if (courseView && courseView.classList.contains('active')) {
      await loadCourseLessons(course);
    }

  } catch (error) {
    console.error("Error saving lesson:", error);
    showAlert('‚ùå Error saving lesson: ' + error.message);
  }
});

// Close CMS when clicking outside
document.getElementById('cmsPanel').addEventListener('click', function(e) {
  if (e.target === this) {
    closeCMS();
  }
});

// Initial load - show course selection
window.scrollTo(0, 0);
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>German Adults â€” Mini Course</title>
<meta name="theme-color" content="#4CAF50"/>
<style>
:root{
  --accent:#4CAF50;
  --good:#4CAF50;
  --bad:#FF6B6B;
  --card:#fff;
  --shadow:0 10px 28px rgba(10,20,30,.08);
  --r:14px;
}
*{box-sizing:border-box}
body{font-family:Arial,system-ui,sans-serif;margin:0;background:linear-gradient(180deg,#E1F5FE,#D0F0FF);color:#212121;display:flex;flex-direction:column;align-items:center;}
header{width:100%;background:var(--accent);color:#fff;padding:12px 20px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:10}
header .brand{font-weight:800;font-size:1.2rem}
header .stats{display:flex;gap:1rem;font-weight:700}
.badge{background:rgba(255,255,255,.2);padding:.25rem .5rem;border-radius:999px;font-size:.85rem}
main{width:100%;max-width:800px;padding:16px;display:flex;flex-direction:column;gap:16px}
.lesson-list{display:flex;flex-direction:column;gap:12px}
.lesson-card{background:var(--card);border-radius:12px;box-shadow:var(--shadow);padding:12px;display:flex;justify-content:space-between;align-items:center;cursor:pointer}
.lesson-title{font-weight:700;font-size:1rem}
.lesson-subtitle{font-size:.85rem;color:#555}
.card{background:#fff;border-radius:12px;padding:12px;border:1px solid rgba(0,0,0,.08);margin-bottom:12px}
.sentence{margin-top:10px;padding:10px;border-radius:10px;background:linear-gradient(90deg,rgba(76,175,80,.06),rgba(129,199,132,.03));font-weight:800;display:flex;gap:10px;align-items:center}
.choices{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px}
.choice{background:#fff;padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,.06);display:flex;align-items:center;gap:8px;cursor:pointer}
.feedback{height:36px;margin-top:10px;font-weight:800}
.progress{height:8px;background:#e6f7ff;border-radius:999px;overflow:hidden;margin-top:10px}
.progress > div{height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--good));transition:width .4s}
.btn{padding:10px;border-radius:10px;border:none;cursor:pointer;font-weight:800}
.btn-primary{background:var(--accent);color:#fff}
.small{font-size:.85rem;color:#555}
.hidden{display:none}
</style>
</head>
<body>
<header>
  <div class="brand">ğŸŒŸ German Adults Mini Course</div>
  <div class="stats">
    <div class="badge" id="streak">ğŸ”¥ 0</div>
    <div class="badge" id="xp">â­ 0 XP</div>
  </div>
</header>
<main>
  <!-- Home / Lessons -->
  <div id="home">
    <h2>Choose a Lesson</h2>
    <div class="lesson-list" id="lessonList"></div>
    <div class="card" style="text-align:center;cursor:pointer" onclick="goFinalReview()">
      ğŸ® Final Review Game
    </div>
  </div>

  <!-- Lesson Content -->
  <div id="lessonPage" class="hidden">
    <div class="card">
      <div class="sentence" id="practiceSentence"></div>
      <div class="progress"><div id="bar"></div></div>
      <div class="choices" id="options"></div>
      <div class="feedback" id="feedback" aria-live="polite"></div>
      <div style="display:flex;justify-content:space-between;margin-top:12px">
        <button class="btn" onclick="skip()">Skip</button>
        <button class="btn btn-primary" id="nextBtn" onclick="nextQ()" disabled>Next â†’</button>
      </div>
      <button class="btn" style="margin-top:12px" onclick="backHome()">ğŸ  Back to Home</button>
    </div>
  </div>

  <!-- Final Review -->
  <div id="finalReview" class="hidden">
    <div class="card">
      <div style="font-weight:800;text-align:center">ğŸ‰ Final Review Game â€” All Lessons ğŸ‰</div>
      <div class="sentence" id="practiceSentenceFR"></div>
      <div class="progress"><div id="barFR"></div></div>
      <div class="choices" id="optionsFR"></div>
      <div class="feedback" id="feedbackFR" aria-live="polite"></div>
      <div style="display:flex;justify-content:space-between;margin-top:12px">
        <button class="btn" onclick="skipFR()">Skip</button>
        <button class="btn btn-primary" id="nextBtnFR" onclick="nextQFR()" disabled>Next â†’</button>
      </div>
      <button class="btn" style="margin-top:12px" onclick="backHome()">ğŸ  Back to Home</button>
    </div>
  </div>
</main>

<script>
// 20 Lessons
const LESSONS=[
{emoji:"ğŸ‘‹",name:"Hallo",sentence:"Hallo! Wie geht's?"},
{emoji:"ğŸ“",name:"Name",sentence:"Ich heiÃŸe Anna."},
{emoji:"ğŸ”¢",name:"Zahlen",sentence:"Ich habe drei Ã„pfel."},
{emoji:"â°",name:"Uhrzeit",sentence:"Es ist neun Uhr."},
{emoji:"ğŸ“…",name:"Wochentage",sentence:"Heute ist Montag."},
{emoji:"ğŸ½ï¸",name:"Essen",sentence:"Ich mag Pizza."},
{emoji:"â˜•",name:"GetrÃ¤nke",sentence:"Ich trinke Wasser."},
{emoji:"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§",name:"Familie",sentence:"Mein Bruder heiÃŸt Max."},
{emoji:"ğŸ’¼",name:"Beruf",sentence:"Ich bin Lehrer."},
{emoji:"ğŸ¨",name:"Hobbys",sentence:"Mein Hobby ist Malen."},
{emoji:"ğŸ›ï¸",name:"Einkaufen",sentence:"Ich gehe einkaufen."},
{emoji:"âœˆï¸",name:"Reisen",sentence:"Ich reise nach Berlin."},
{emoji:"ğŸ ",name:"Haus",sentence:"Mein Haus ist klein."},
{emoji:"ğŸ™ï¸",name:"Stadt",sentence:"Ich wohne in der Stadt."},
{emoji:"ğŸŒ¤ï¸",name:"Wetter",sentence:"Heute ist das Wetter schÃ¶n."},
{emoji:"ğŸ‘•",name:"Kleidung",sentence:"Ich trage ein blaues Hemd."},
{emoji:"ğŸ’Š",name:"Gesundheit",sentence:"Mir geht es nicht gut."},
{emoji:"ğŸš†",name:"Transport",sentence:"Ich fahre mit dem Zug."},
{emoji:"ğŸ“",name:"Telefon",sentence:"Ich rufe meinen Freund an."}
];

// State
let state={index:0,xp:0,streak:0,order:[],wrongQueue:[]};
let frState={index:0,xp:0,streak:0,order:[],wrongQueue:[]};

// Load / Save
function loadProgress(){
  const s=JSON.parse(localStorage.getItem('germanState')||'{}');
  state.xp=s.xp||0;state.streak=s.streak||0;
}
function save(){localStorage.setItem('germanState',JSON.stringify({xp:state.xp,streak:state.streak}));}
function renderHeader(){document.getElementById('xp').textContent=`â­ ${state.xp} XP`;document.getElementById('streak').textContent=`ğŸ”¥ ${state.streak}`;}
function speak(txt){if(window.speechSynthesis){const u=new SpeechSynthesisUtterance(txt);u.lang='de-DE';window.speechSynthesis.cancel();window.speechSynthesis.speak(u);}}

// Home Page
function loadLessons(){
  const container=document.getElementById('lessonList');
  container.innerHTML='';
  LESSONS.forEach((l,i)=>{
    const div=document.createElement('div');
    div.className='lesson-card';
    div.innerHTML=`<div><span class="lesson-title">${l.emoji} ${l.name}</span><br><span class="lesson-subtitle">${l.sentence}</span></div>`;
    div.onclick=()=>startLesson(i);
    container.appendChild(div);
  });
}

// Lesson functions
function startLesson(i){
  document.getElementById('home').classList.add('hidden');
  document.getElementById('lessonPage').classList.remove('hidden');
  state.index=0;state.order=[LESSONS[i]];state.wrongQueue=[];
  loadQ();
}

function loadQ(){
  const cur=state.order[state.index];
  document.getElementById('practiceSentence').textContent=cur.sentence;
  speak(cur.sentence);
  document.getElementById('bar').style.width=`${(state.index/state.order.length)*100}%`;
  document.getElementById('feedback').textContent='';
  document.getElementById('nextBtn').disabled=true;

  const opts=shuffle([...LESSONS].slice(0,4));
  const container=document.getElementById('options');container.innerHTML='';
  opts.forEach(opt=>{
    const d=document.createElement('div');d.className='choice';
    d.innerHTML=`<div style="font-size:1.5rem">${opt.emoji}</div><div style="font-weight:700">${opt.name}</div>`;
    d.onclick=()=>choose(opt.name,cur.name,d);
    container.appendChild(d);
  });
}

function choose(sel,correct,node){
  if(sel===correct){
    state.xp+=5;state.streak++;save();renderHeader();
    document.getElementById('feedback').innerHTML=`<span style="color:var(--good)">âœ… Richtig!</span>`;
    node.style.boxShadow='0 10px 24px rgba(72,187,120,.14)';
    document.getElementById('nextBtn').disabled=false;
  }else{
    state.xp+=1;state.streak=0;save();renderHeader();
    document.getElementById('feedback').innerHTML=`<span style="color:var(--bad)">âŒ Falsch!</span>`;
    state.wrongQueue.push(state.order[state.index]);
  }
}

function nextQ(){state.index++;if(state.index>=state.order.length && state.wrongQueue.length>0){state.order=state.wrongQueue;state.index=0;state.wrongQueue=[];}else if(state.index>=state.order.length){backHome();return;}loadQ();}
function skip(){nextQ();}
function backHome(){document.getElementById('lessonPage').classList.add('hidden');document.getElementById('finalReview').classList.add('hidden');document.getElementById('home').classList.remove('hidden');loadLessons();}

// Final Review functions
function goFinalReview(){
  document.getElementById('home').classList.add('hidden');
  document.getElementById('finalReview').classList.remove('hidden');
  frState.order=shuffle([...LESSONS]);frState.index=0;frState.wrongQueue=[];
  loadQFR();
}
function loadQFR(){
  if(frState.index>=frState.order.length && frState.wrongQueue.length===0){alert("ğŸ‰ Final Review Complete!");backHome();return;}
  if(frState.index>=frState.order.length){frState.order=frState.wrongQueue;frState.index=0;frState.wrongQueue=[];}
  const cur=frState.order[frState.index];
  document.getElementById('practiceSentenceFR').textContent=cur.sentence;
  speak(cur.sentence);
  document.getElementById('barFR').style.width=`${(frState.index/frState.order.length)*100}%`;
  document.getElementById('feedbackFR').textContent='';
  document.getElementById('nextBtnFR').disabled=true;

  let opts=shuffle([...LESSONS].slice(0,4));
  if(!opts.some(o=>o.name===cur.name)) opts[0]=cur;
  opts=shuffle(opts);
  const container=document.getElementById('optionsFR');container.innerHTML='';
  opts.forEach(opt=>{
    const d=document.createElement('div');d.className='choice';
    d.innerHTML=`<div style="font-size:1.5rem">${opt.emoji}</div><div style="font-weight:700">${opt.name}</div>`;
    d.onclick=()=>chooseFR(opt.name,cur.name,d);
    container.appendChild(d);
  });
}

function chooseFR(sel,correct,node){
  const cur=frState.order[frState.index];
  if(sel===correct){
    frState.xp+=5;frState.streak++;save();renderHeader();
    document.getElementById('feedbackFR').innerHTML=`<span style="color:var(--good)">âœ… Richtig!</span>`;
    node.style.boxShadow='0 10px 24px rgba(72,187,120,.14)';
    document.getElementById('nextBtnFR').disabled=false;
  }else{
    frState.xp+=1;frState.streak=0;save();renderHeader();
    document.getElementById('feedbackFR').innerHTML=`<span style="color:var(--bad)">âŒ Falsch!</span>`;
    frState.wrongQueue.push(cur);
  }
}

function nextQFR(){frState.index++;loadQFR();}
function skipFR(){nextQFR();}
function shuffle(a){return a.sort(()=>Math.random()-0.5);}
loadProgress();renderHeader();loadLessons();
</script>
</body>
</html>
